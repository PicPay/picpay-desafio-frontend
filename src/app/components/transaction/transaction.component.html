<div class="modal-backdrop">
    <div class="container row justify-content-center modal-container">

        <div *ngIf="isOnTransaction()" class="col-12 col-sm-11 col-md-9 col-lg-8 modal">
            <div class="container px-5 pb-4 pb-lg-3 modal__content">
                <div class="row modal__content__header">

                    <div class="col-11 title">
                        <h1>Efetuar Pagamento</h1>
                    </div>

                    <h1 
                     class="col-1 px-2 d-flex justify-content-end align-items-start close"
                     (click)="transactionService.endTransaction()">
                        x
                    </h1>
                </div>            
                

                <form 
                 class="row modal__content__form"
                 [formGroup]="transactionForm">
                    
                    <h3 class="modal__content__form__description">
                        Preencha o campo abaixo com o valor, e logo em seguida selecione o cartão desejado 
                         para então efetuar a transação à <strong>{{transactionUser.name}}</strong>. 
                    </h3>

                    <label>- Informe o valor da transação:</label>
                    <input
                     class="modal__content__form__value"
                     required
                     type="text"
                     appBrlCurrencyMask
                     formControlName="value"/>
                    
                    <label>- Selecione o cartão de crédito: </label>

                    <div class="modal__content__form__cards">

                        <label class="radio-card-button" *ngFor="let card of cards; let index = index;">
                            <input
                             formControlName="card"
                             [id]="('card'+(index+1))"
                             type="radio"
                             [value]="card"
                             class="card-input-element d-none" >
                            <span 
                             class="card card-body d-flex flex-row justify-content-between align-items-center px-4 py-0"
                             [ngClass]="{ 'mb-4' : index === (cards.length -1)}">
                                <div class="modal__content__form__cards__card">
                                    <strong> {{ changeFirstCharsToStars(card.card_number) }} </strong>
                                    <span> <strong>CVV :</strong> {{ card.cvv }}</span>
                                    <span> <strong>Exp. date :</strong> {{ card.expiry_date }}</span>  
                                </div>
                            </span>
                        </label>

                        <!-- <select
                         required
                         formControlName="card">
                            <option
                             *ngFor="let card of cards; let index = index;"
                             [ngValue]="card">
                                Cartão com final {{ endCharactersOf(card.card_number) }}
                            </option>
                        </select> -->
                    </div>
                
                    <div class="footer pt-4">
                        <button 
                         type="button"
                         class="footer__pay-button"
                         (click)="pay()">
                            Pagar
                        </button>
                    </div>
                </form>
            </div>
        </div>

            <div *ngIf="isTransactionSucceeded() || isTransactionFailed()" class="modal">
            <div class="title">
                <span>Recibo de pagamento</span>
                <span 
                 class="close"
                 (click)="transactionService.endTransaction()">
                    x
                </span>
            </div>

            <div *ngIf="isTransactionSucceeded()" class="content">
                O pagamento foi concluido com sucesso.
            </div>
            <div *ngIf="isTransactionFailed()" class="content">
                O pagamento <strong>não</strong> foi concluido com sucesso.
            </div>

            </div>
        

    </div>
</div>